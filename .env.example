# Prexis 环境变量配置
# 复制为 .env 用于本地开发
# 生产环境通过 Docker / K8s 注入

# ============ 应用配置 ============
# NODE_ENV 只支持 dev 和 prod
NODE_ENV=dev
PORT=3000
# 服务器绑定地址 (0.0.0.0 = 所有网卡, 127.0.0.1 = 仅本地)
HOST=0.0.0.0

# ============ HTTP/2 配置 ============
# 启用 HTTP/2 (开发环境默认启用，使用自动生成的证书)
# HTTP2_ENABLED=true  # 开发环境自动启用，无需设置
# HTTP/2 端口 (与 HTTP/1.1 分开)
HTTP2_PORT=3443
# SSL 证书路径 (相对于项目根目录，开发证书自动生成)
HTTP2_CERT_PATH=certs/server.crt
HTTP2_KEY_PATH=certs/server.key

# ============ 数据库配置 ============
DATABASE_URL="mysql://root:password@localhost:3306/prexis"
MYSQL_ROOT_PASSWORD=password
MYSQL_DATABASE=prexis

# ============ Redis 配置 ============
# 启用 Redis (生产环境必须启用)
REDIS_ENABLED=true
# Redis 连接地址
REDIS_URL=redis://localhost:6379
# Redis 键前缀
REDIS_PREFIX=prexis:

# ============ 安全配置 ============
# JWT 密钥 (生产环境请使用强密钥，至少 32 字符)
SECRET_KEY=your-secret-key-change-in-production
# 启用 CORS 凭证
CREDENTIALS=true
# 允许的跨域来源 (* 表示所有，生产环境请设置具体域名)
ORIGIN=*
# 启用 CSRF 保护 (生产环境建议启用)
CSRF_ENABLED=false
# CSRF 密钥 (不设置则使用 SECRET_KEY)
CSRF_SECRET=

# ============ 日志配置 ============
# 日志格式: dev, combined, common, short, tiny
# 开发环境默认 dev，生产环境默认 combined
LOG_FORMAT=dev
# 日志目录
LOG_DIR=logs

# ============ WebSocket 配置 ============
# WebSocket 路径
WS_PATH=/ws
# 心跳间隔 (单位: 毫秒, 默认 30000ms = 30秒)
WS_HEARTBEAT_INTERVAL=30000

# ============ OpenTelemetry 配置 ============
# 启用分布式追踪
OTEL_ENABLED=false
# 服务名称
OTEL_SERVICE_NAME=prexis
# OTLP 导出端点
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
# 采样率 (0.0-1.0, 1.0=100% 采样)
OTEL_SAMPLING_RATIO=1.0

# ============ 速率限制配置 ============
# API 速率限制 - 时间窗口 (单位: 毫秒, 默认 60000ms = 1分钟)
RATE_LIMIT_WINDOW_MS=60000
# API 速率限制 - 窗口内最大请求数
RATE_LIMIT_MAX=100
# 认证接口速率限制 - 时间窗口 (单位: 毫秒, 默认 900000ms = 15分钟)
AUTH_RATE_LIMIT_WINDOW_MS=900000
# 认证接口速率限制 - 窗口内最大请求数 (防止暴力破解)
AUTH_RATE_LIMIT_MAX=10

# ============ Worker Pool 配置 ============
# 启用 Worker 线程池 (用于 CPU 密集型任务)
WORKER_POOL_ENABLED=false
# Worker 数量 (默认 CPU 核心数 - 1，0 = 自动)
WORKER_POOL_SIZE=0
# Worker 任务超时 (单位: 毫秒, 默认 30000ms = 30秒)
WORKER_TASK_TIMEOUT=30000

# ============ 性能配置 ============
# 请求超时时间 (单位: 毫秒)
REQUEST_TIMEOUT=30000
# 慢请求阈值 (单位: 毫秒, 超过此时间记录警告)
SLOW_REQUEST_THRESHOLD=3000
# Keep-Alive 超时 (单位: 毫秒)
KEEP_ALIVE_TIMEOUT=65000
